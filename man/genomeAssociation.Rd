% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/vgwas.R
\name{genomeAssociation}
\alias{genomeAssociation}
\title{Perform Association Studies Across Genomic Data}
\usage{
genomeAssociation(
  data,
  start = 1,
  end,
  formula,
  aa.freq.cutoff,
  fdr,
  mode = c("all", "dominant")
)
}
\arguments{
\item{data}{A data.frame or data.table containing rows per sample with required model data
and amino acids for each position in the genome labeled X1:Xn.}

\item{start}{Integer. Amino acid position to start the analysis (default = 1).}

\item{end}{Integer. Amino acid position to end the analysis.}

\item{formula}{Formula object. Model formula to use for logistic regression on each site.}

\item{aa.freq.cutoff}{Integer. Minimum number of samples required for an amino acid to be included in test.}

\item{fdr}{Numeric. False discovery rate threshold between 0 and 1.}

\item{mode}{Character. Either "all" (compare each amino acid against all others) or
"dominant" (compare only the most common amino acid against all others).}
}
\value{
A data.table containing the association study results ordered by p-value.
}
\description{
This function performs association studies across genomic data, supporting two different modes:
1) comparing each amino acid with count > aa.freq.cutoff against all others at each site, or
2) comparing only the most common amino acid against all others at each site.
}
\examples{
\dontrun{
# Load example data
data <- read.csv("genome_data.csv")

# Define formula for model
model_formula <- outcome ~ site + covariate1 + covariate2

# Run analysis comparing all amino acids at each position
results_all <- genomeAssociation(
  data = data,
  start = 1,
  end = 500,
  formula = model_formula,
  aa.freq.cutoff = 10,
  fdr = 0.05,
  mode = "all"
)

# Run analysis comparing only dominant amino acid
results_dominant <- genomeAssociation(
  data = data,
  start = 1,
  end = 500,
  formula = model_formula,
  aa.freq.cutoff = 10,
  fdr = 0.05,
  mode = "dominant"
)
}

}
